"use strict";(self.webpackChunkmaze=self.webpackChunkmaze||[]).push([[309],{309:(P,v,i)=>{i.r(v),i.d(v,{YoutubeModule:()=>S});var g=i(6895),b=i(2496),O=i(5861),y=i(6805),Y=i(930),e=i(4650),p=i(529),C=i(4128),_=i(2843),h=i(262),u=i(4004),x=i(3900);let a=(()=>{class o{constructor(t){this.http=t,this.apiKey="YOUR_API_KEY"}getSubscriptions(t){const n=`https://www.googleapis.com/youtube/v3/subscriptions?part=snippet&mine=true&maxResults=50&key=${this.apiKey}`,r=new p.WM({Authorization:`Bearer ${t}`});return this.http.get(n,{headers:r}).pipe((0,h.K)(this.handleError))}getMostRecentVideo(t,n){const r=`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${t}&order=date&maxResults=1&key=${this.apiKey}`,d=new p.WM({Authorization:`Bearer ${n}`});return this.http.get(r,{headers:d}).pipe((0,u.U)(c=>c.items[0]),(0,h.K)(this.handleError))}getRecentVideosFromSubscriptions(t){return this.getSubscriptions(t).pipe((0,x.w)(n=>{const d=n.items.map(c=>c.snippet.resourceId.channelId).map(c=>this.getMostRecentVideo(c,t));return(0,C.D)(d).pipe((0,u.U)(c=>c.flat()),(0,u.U)(c=>c.sort((Z,w)=>new Date(w.snippet.publishedAt).getTime()-new Date(Z.snippet.publishedAt).getTime())),(0,u.U)(c=>c.slice(0,20)),(0,h.K)(this.handleError))}))}handleError(t){console.error("An error occurred:",t);let n="Something went wrong; please try again later.";return n=t.error instanceof ErrorEvent?`Client-side error: ${t.error.message}`:`Server-side error: ${t.error.error?.message||t.message} (Status: ${t.status})`,(0,_._)(()=>new Error(n))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(p.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function l(o,s){1&o&&(e.TgZ(0,"div",5)(1,"p"),e._uU(2,"Login to see your videos"),e.qZA(),e._UZ(3,"div",6),e.qZA())}function f(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",7)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.getYouTubeSubscriptions())}),e._uU(4,"Retry"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(2),e.Oqu(t.error)}}function T(o,s){if(1&o&&(e.TgZ(0,"li",11)(1,"a",12),e._UZ(2,"img",13),e.TgZ(3,"div",14)(4,"h3",15),e._uU(5),e.qZA(),e.TgZ(6,"p",16),e._uU(7),e.ALo(8,"date"),e.qZA()()()()),2&o){const t=s.$implicit;e.xp6(1),e.Q6J("href","https://www.youtube.com/watch?v="+t.id.videoId,e.LSH),e.xp6(1),e.s9C("alt",t.snippet.title),e.Q6J("src","https://img.youtube.com/vi/"+t.id.videoId+"/hqdefault.jpg",e.LSH),e.xp6(3),e.Oqu(t.snippet.title),e.xp6(2),e.hij("Published on: ",e.xi3(8,5,t.snippet.publishedAt,"shortDate"),"")}}function M(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",9)(1,"h2"),e._uU(2,"Recent Videos from Your Subscriptions"),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.getYouTubeSubscriptions())}),e._uU(4,"Refresh"),e.qZA(),e.TgZ(5,"ul"),e.YNc(6,T,9,8,"li",10),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.recentVideos)}}function m(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",17)(1,"p"),e._uU(2,"No recent videos found."),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.getYouTubeSubscriptions())}),e._uU(4,"Refresh"),e.qZA()()}}const A=[{path:"",component:(()=>{class o{constructor(t,n){this.youtubeService=t,this.cdr=n,this.recentVideos=[],this.loading=!0,this.error=null,this.CLIENT_ID="500954188018-pl7ri0a7qbq1gd4gd71gaafkp4udf1n1.apps.googleusercontent.com",this.accessToken=null}ngOnInit(){}ngAfterViewInit(){this.initializeGoogleSignIn()}initializeGoogleSignIn(){google.accounts.id.initialize({client_id:this.CLIENT_ID,callback:this.handleCredentialResponse.bind(this)}),console.log("Google Sign-In initialized"),google.accounts.id.renderButton(document.getElementById("google-signin-button"),{theme:"outline",size:"large"}),this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.CLIENT_ID,scope:"https://www.googleapis.com/auth/youtube.readonly",callback:this.handleTokenResponse.bind(this)})}handleCredentialResponse(t){console.log("Google ID Token:",t.credential),this.tokenClient.requestAccessToken()}handleTokenResponse(t){console.log("Access Token:",t.access_token),this.accessToken=t.access_token,this.loadRecentVideos()}getYouTubeSubscriptions(){this.accessToken?fetch("https://www.googleapis.com/youtube/v3/subscriptions?part=snippet&mine=true",{headers:{Authorization:`Bearer ${this.accessToken}`}}).then(n=>n.json()).then(n=>{console.log("YouTube Subscriptions:",n)}).catch(n=>console.error("Error fetching YouTube subscriptions:",n)):console.error("No access token found.")}loadRecentVideos(){var t=this;return(0,O.Z)(function*(){try{t.loading=!0,t.recentVideos=yield function I(o,s){const t="object"==typeof s;return new Promise((n,r)=>{const d=new Y.Hp({next:c=>{n(c),d.unsubscribe()},error:r,complete:()=>{t?n(s.defaultValue):r(new y.K)}});o.subscribe(d)})}(t.youtubeService.getRecentVideosFromSubscriptions(t.accessToken)),console.log("Recent Videos:",t.recentVideos)}catch(n){t.error="Error fetching recent videos",console.error("Error fetching recent videos:",n)}finally{t.loading=!1,t.cdr.detectChanges()}})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(a),e.Y36(e.sBO))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-youtube"]],decls:5,vars:4,consts:[[1,"container"],["class","loading-message",4,"ngIf"],["class","error-message",4,"ngIf"],["class","videos-list",4,"ngIf"],["class","no-videos-message",4,"ngIf"],[1,"loading-message"],["id","google-signin-button",1,"signin-button"],[1,"error-message"],[3,"click"],[1,"videos-list"],["class","video-item",4,"ngFor","ngForOf"],[1,"video-item"],["target","_blank",3,"href"],[1,"thumbnail",3,"src","alt"],[1,"video-details"],[1,"video-title"],[1,"video-date"],[1,"no-videos-message"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,l,4,0,"div",1),e.YNc(2,f,5,1,"div",2),e.YNc(3,M,7,1,"div",3),e.YNc(4,m,5,0,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading&&n.error),e.xp6(1),e.Q6J("ngIf",!n.loading&&!n.error&&n.recentVideos.length>0),e.xp6(1),e.Q6J("ngIf",!n.loading&&!n.error&&0===n.recentVideos.length))},dependencies:[g.sg,g.O5,g.uU],styles:[".container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:20px}.loading-message[_ngcontent-%COMP%]{text-align:center;font-size:18px;color:#555}.signin-button[_ngcontent-%COMP%]{margin-top:20px;text-align:center}.error-message[_ngcontent-%COMP%]{text-align:center;font-size:18px;color:#e74c3c}.videos-list[_ngcontent-%COMP%]{padding:10px}.videos-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px}.video-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:20px;border-bottom:1px solid #ddd;padding-bottom:10px}.thumbnail[_ngcontent-%COMP%]{width:120px;height:90px;margin-right:15px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.video-details[_ngcontent-%COMP%]{flex:1}.video-title[_ngcontent-%COMP%]{font-size:18px;color:#333;margin:0;text-decoration:none;display:block}.video-title[_ngcontent-%COMP%]:hover{text-decoration:underline}.video-date[_ngcontent-%COMP%]{color:#777}.no-videos-message[_ngcontent-%COMP%]{text-align:center;font-size:18px;color:#555}"]}),o})()}];let R=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[b.Bz.forChild(A),b.Bz]}),o})(),S=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[a],imports:[g.ez,p.JF,R]}),o})()},4128:(P,v,i)=>{i.d(v,{D:()=>p});var g=i(9751),b=i(4742),O=i(8421),y=i(7669),Y=i(5403),I=i(3268),e=i(1810);function p(...C){const _=(0,y.jO)(C),{args:h,keys:u}=(0,b.D)(C),x=new g.y(a=>{const{length:l}=h;if(!l)return void a.complete();const f=new Array(l);let T=l,M=l;for(let m=0;m<l;m++){let E=!1;(0,O.Xf)(h[m]).subscribe((0,Y.x)(a,A=>{E||(E=!0,M--),f[m]=A},()=>T--,void 0,()=>{(!T||!E)&&(M||a.next(u?(0,e.n)(u,f):f),a.complete())}))}});return _?x.pipe((0,I.Z)(_)):x}}}]);